ability_id: 300157e5-f4ad-4569-b533-9d1fa0e74d74
access: {}
additional_info: {}
buckets:
- exfiltration
delete_payload: true
description: Compress a directory on the file system
executors:
- additional_info: {}
  build_target: null
  cleanup:
  - 'rm #{host.dir.staged}.tar.gz'
  code: null
  command: 'tar -P -zcf #{host.dir.staged}.tar.gz #{host.dir.staged} && echo #{host.dir.staged}.tar.gz'
  language: null
  name: sh
  parsers:
  - module: plugins.stockpile.app.parsers.basic
    parserconfigs:
    - custom_parser_vals: {}
      edge: ''
      source: host.dir.compress
      target: ''
  payloads: []
  platform: darwin
  timeout: 60
  uploads: []
  variations: []
- additional_info: {}
  build_target: null
  cleanup:
  - 'rm #{host.dir.staged}.tar.gz'
  code: null
  command: 'tar -P -zcf #{host.dir.staged}.tar.gz #{host.dir.staged} && echo #{host.dir.staged}.tar.gz'
  language: null
  name: sh
  parsers:
  - module: plugins.stockpile.app.parsers.basic
    parserconfigs:
    - custom_parser_vals: {}
      edge: ''
      source: host.dir.compress
      target: ''
  payloads: []
  platform: linux
  timeout: 60
  uploads: []
  variations: []
- additional_info: {}
  build_target: null
  cleanup:
  - 'rm #{host.dir.staged}.zip'
  code: null
  command: 'Compress-Archive -Path #{host.dir.staged} -DestinationPath #{host.dir.staged}.zip
    -Force;

    sleep 1; ls #{host.dir.staged}.zip | foreach {$_.FullName} | select'
  language: null
  name: psh
  parsers:
  - module: plugins.stockpile.app.parsers.basic
    parserconfigs:
    - custom_parser_vals: {}
      edge: ''
      source: host.dir.compress
      target: ''
  payloads: []
  platform: windows
  timeout: 60
  uploads: []
  variations: []
- additional_info: {}
  build_target: null
  cleanup:
  - 'rm #{host.dir.staged}.zip'
  code: null
  command: 'Compress-Archive -Path #{host.dir.staged} -DestinationPath #{host.dir.staged}.zip
    -Force;

    sleep 1; ls #{host.dir.staged}.zip | foreach {$_.FullName} | select'
  language: null
  name: pwsh
  parsers:
  - module: plugins.stockpile.app.parsers.basic
    parserconfigs:
    - custom_parser_vals: {}
      edge: ''
      source: host.dir.compress
      target: ''
  payloads: []
  platform: windows
  timeout: 60
  uploads: []
  variations: []
name: Compress staged directory
plugin: stockpile
privilege: ''
repeatable: false
requirements:
- module: plugins.stockpile.app.requirements.paw_provenance
  relationship_match:
  - source: host.dir.staged
singleton: false
tactic: exfiltration
technique_id: T1560.001
technique_name: 'Archive Collected Data: Archive via Utility'
